<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Tic Tac Toe — Simple Game</title>
  <style>
    :root {
      --bg: #0f1724;
      --card: #0b1220;
      --accent: #06b6d4;
      --muted: #94a3b8;
      --x-color: #ef4444;
      --o-color: #60a5fa;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }

    * {
      box-sizing: border-box
    }

    html,
    body {
      height: 100%
    }

    body {
      margin: 0;
      background: linear-gradient(180deg, var(--bg) 0%, #071126 100%);
      color: #e6eef8;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 24px;
    }

    .container {
      width: 100%;
      max-width: 820px;
      background: linear-gradient(180deg, rgba(255, 255, 255, 0.02), rgba(255, 255, 255, 0.01));
      border-radius: 14px;
      padding: 20px;
      box-shadow: 0 10px 30px rgba(2, 6, 23, 0.6);
      border: 1px solid rgba(255, 255, 255, 0.03);
      display: grid;
      grid-template-columns: 1fr 320px;
      gap: 18px;
    }

    header {
      grid-column: 1/-1;
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 6px
    }

    h1 {
      font-size: 20px;
      margin: 0
    }

    .left-info {
      display: flex;
      gap: 12px;
      align-items: center
    }

    .mode-select {
      background: transparent;
      border: 1px solid rgba(255, 255, 255, 0.04);
      padding: 6px;
      border-radius: 8px;
      color: var(--muted)
    }

    /* board */
    .board-wrap {
      display: flex;
      flex-direction: column;
      gap: 12px;
      align-items: center;
      justify-content: center
    }

    .status {
      font-size: 14px;
      color: var(--muted)
    }

    .board {
      width: min(420px, 80vw);
      height: min(420px, 80vw);
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      padding: 10px;
      background: linear-gradient(180deg, rgba(255, 255, 255, 0.02), rgba(255, 255, 255, 0.01));
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.03);
    }

    .cell {
      background: linear-gradient(180deg, rgba(255, 255, 255, 0.015), rgba(255, 255, 255, 0.01));
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 64px;
      cursor: pointer;
      user-select: none;
      transition: transform .08s ease, background .12s;
      box-shadow: inset 0 -4px 8px rgba(2, 6, 23, 0.6);
    }

    .cell:active {
      transform: scale(.98)
    }

    .cell.x {
      color: var(--x-color)
    }

    .cell.o {
      color: var(--o-color)
    }

    /* side panel */
    .sidebar {
      background: linear-gradient(180deg, rgba(255, 255, 255, 0.02), rgba(255, 255, 255, 0.01));
      padding: 18px;
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.03);
      display: flex;
      flex-direction: column;
      gap: 12px
    }

    .score {
      display: flex;
      gap: 12px;
      align-items: center;
      justify-content: space-between
    }

    .score .box {
      flex: 1;
      padding: 12px;
      border-radius: 10px;
      background: rgba(255, 255, 255, 0.02);
      text-align: center
    }

    .box h3 {
      margin: 0;
      font-size: 14px;
      color: var(--muted)
    }

    .box p {
      margin: 6px 0 0;
      font-weight: 700;
      font-size: 18px
    }

    .controls {
      display: flex;
      gap: 10px
    }

    button {
      background: var(--accent);
      border: none;
      padding: 10px 12px;
      border-radius: 10px;
      color: #042027;
      font-weight: 600;
      cursor: pointer
    }

    button.ghost {
      background: transparent;
      border: 1px solid rgba(255, 255, 255, 0.06);
      color: var(--muted);
      font-weight: 600
    }

    .small {
      font-size: 13px;
      color: var(--muted)
    }

    footer {
      grid-column: 1/-1;
      text-align: center;
      color: var(--muted);
      font-size: 12px;
      margin-top: 6px
    }

    @media(max-width:760px) {
      .container {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <header>
      <div class="left-info">
        <h1>Tic Tac Toe</h1>
        <select id="mode" class="mode-select" title="Choose mode">
          <option value="pvp">2 Players (Local)</option>
          <option value="pvc">1 Player (vs CPU)</option>
        </select>
      </div>
      <div>
        <small class="small">Turn: <strong id="turn-label">X</strong></small>
      </div>
    </header>

    <section class="board-wrap">
      <div class="status" id="status">Click any cell to start</div>
      <div class="board" id="board" aria-label="tic tac toe board">
        <!-- 9 cells -->
        <div class="cell" data-index="0"></div>
        <div class="cell" data-index="1"></div>
        <div class="cell" data-index="2"></div>
        <div class="cell" data-index="3"></div>
        <div class="cell" data-index="4"></div>
        <div class="cell" data-index="5"></div>
        <div class="cell" data-index="6"></div>
        <div class="cell" data-index="7"></div>
        <div class="cell" data-index="8"></div>
      </div>
      <div style="display:flex;gap:8px;">
        <button id="undo" class="ghost">Undo</button>
        <button id="reset" class="ghost">Reset</button>
      </div>
    </section>

    <aside class="sidebar">
      <div class="score">
        <div class="box">
          <h3>X (You)</h3>
          <p id="score-x">0</p>
        </div>
        <div class="box">
          <h3>Draws</h3>
          <p id="score-d">0</p>
        </div>
        <div class="box">
          <h3>O (CPU/Player 2)</h3>
          <p id="score-o">0</p>
        </div>
      </div>

      <div class="small">Start with X. CPU plays O. CPU uses a simple strategy (block/win/random).</div>

      <div class="controls">
        <button id="new-game">New Game</button>
        <button id="swap" class="ghost">Swap Sides</button>
      </div>
      <div class="small">Tip: Use Undo to revert last move. Swap Sides to switch who starts.</div>
    </aside>

    <footer>Built with HTML · CSS · JavaScript</footer>
  </div>

  <script>
    // Tic Tac Toe game logic
    const boardEl = document.getElementById('board')
    const cells = Array.from(document.querySelectorAll('.cell'))
    const statusEl = document.getElementById('status')
    const turnLabel = document.getElementById('turn-label')
    const modeSelect = document.getElementById('mode')
    const undoBtn = document.getElementById('undo')
    const resetBtn = document.getElementById('reset')
    const newGameBtn = document.getElementById('new-game')
    const swapBtn = document.getElementById('swap')
    const scoreX = document.getElementById('score-x')
    const scoreO = document.getElementById('score-o')
    const scoreD = document.getElementById('score-d')

    let board = Array(9).fill(null) // 'X' or 'O' or null
    let current = 'X'
    let isGameOver = false
    let history = [] // stack for undo
    let scores = { X: 0, O: 0, D: 0 }
    let humanMark = 'X' // human plays X by default

    const wins = [
      [0, 1, 2], [3, 4, 5], [6, 7, 8],
      [0, 3, 6], [1, 4, 7], [2, 5, 8],
      [0, 4, 8], [2, 4, 6]
    ]

    function render() {
      cells.forEach((cell, i) => {
        cell.classList.remove('x', 'o')
        cell.textContent = board[i] ? board[i] : ''
        if (board[i]) cell.classList.add(board[i].toLowerCase())
      })
      turnLabel.textContent = current
      if (isGameOver) turnLabel.textContent = '-'
    }

    function checkWinner(b) {
      for (const [a, c, d] of wins) {
        if (b[a] && b[a] === b[c] && b[a] === b[d]) return b[a]
      }
      if (b.every(Boolean)) return 'draw'
      return null
    }

    function setStatus() {
      const result = checkWinner(board)
      if (result === 'draw') {
        statusEl.textContent = 'Match Drawn'
      } else if (result) {
        statusEl.textContent = `${result} Wins!`;
      } else {
        statusEl.textContent = `Turn: ${current}`
      }
    }

    function makeMove(index) {
      if (isGameOver) return
      if (board[index]) return
      board[index] = current
      history.push(index)
      const result = checkWinner(board)
      if (result) {
        isGameOver = true
        if (result === 'draw') scores.D++
        else scores[result]++
        updateScores()
        statusEl.textContent = result === 'draw' ? 'Match Drawn' : `${result} Wins!`
      } else {
        current = current === 'X' ? 'O' : 'X'
        statusEl.textContent = `Turn: ${current}`
      }
      render()
      // CPU move if pvc and it's O's turn and not over
      if (modeSelect.value === 'pvc' && !isGameOver) {
        if (current !== humanMark) setTimeout(cpuMove, 350)
      }
    }

    function cpuMove() {
      // simple CPU: win if possible, block if needed, else random
      const b = board.slice()
      // try to win
      for (let i = 0; i < 9; i++) {
        if (!b[i]) {
          b[i] = current
          if (checkWinner(b) === current) { makeMove(i); return }
          b[i] = null
        }
      }
      // try to block opponent
      const opp = current === 'X' ? 'O' : 'X'
      for (let i = 0; i < 9; i++) {
        if (!b[i]) {
          b[i] = opp
          if (checkWinner(b) === opp) { makeMove(i); return }
          b[i] = null
        }
      }
      // choose center, corners, sides preference
      const pref = [4, 0, 2, 6, 8, 1, 3, 5, 7]
      for (const i of pref) { if (!board[i]) { makeMove(i); return } }
    }

    function updateScores() {
      scoreX.textContent = scores.X
      scoreO.textContent = scores.O
      scoreD.textContent = scores.D
    }

    // Events
    cells.forEach(cell => {
      cell.addEventListener('click', (e) => {
        const idx = Number(cell.dataset.index)
        // if pvc and human is O, ignore when it's O's turn
        if (modeSelect.value === 'pvc' && current !== humanMark) { return }
        makeMove(idx)
      })
    })

    undoBtn.addEventListener('click', () => {
      if (history.length === 0 || isGameOver) return
      const last = history.pop()
      board[last] = null
      // if pvc and cpu moved last, also undo one more
      if (modeSelect.value === 'pvc') {
        // if last move left current as O, means we undone human move; better to simply switch turn
      }
      current = current === 'X' ? 'O' : 'X'
      render(); setStatus()
    })

    resetBtn.addEventListener('click', () => {
      board = Array(9).fill(null); history = []; isGameOver = false; current = 'X'; render(); setStatus()
    })

    newGameBtn.addEventListener('click', () => {
      board = Array(9).fill(null); history = []; isGameOver = false; current = 'X'; scores = { X: 0, O: 0, D: 0 }; updateScores(); render(); setStatus()
    })

    swapBtn.addEventListener('click', () => {
      // swap who starts
      humanMark = humanMark === 'X' ? 'O' : 'X'
      current = 'X'
      board = Array(9).fill(null); history = []; isGameOver = false; render(); setStatus()
      alert('Swapped sides. Human is now ' + humanMark)
    })

    modeSelect.addEventListener('change', () => {
      board = Array(9).fill(null); history = []; isGameOver = false; current = 'X'; render(); setStatus()
      // default human is X
      humanMark = 'X'
    })

    // initial render
    render(); setStatus()
  </script>
</body>

</html>